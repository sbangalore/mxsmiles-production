import{g as e,p as t}from"./vendor-C8R_D1-_.js";import{r,u as n}from"./react-core-DUvmEEFD.js";const s="pushState",o="replaceState",a=["popstate",s,o,"hashchange"],c=e=>{for(const t of a)addEventListener(t,e);return()=>{for(const t of a)removeEventListener(t,e)}},l=(t,r)=>e.useSyncExternalStore(c,t,r),i=()=>location.search,h=()=>location.pathname,u=({ssrPath:e}={})=>l(h,e?()=>e:h),f=(e,{replace:t=!1,state:r=null}={})=>history[t?o:s](r,"",e),p=Symbol.for("wouter_v3");if("undefined"!=typeof history&&void 0===window[p]){for(const e of[s,o]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,p,{value:!0})}const d=(e="")=>"/"===e?"":e,m=(e="",t)=>((e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/")(y(d(e)),y(t)),y=e=>{try{return decodeURI(e)}catch(t){return e}},v={hook:(e={})=>[u(e),f],searchHook:({ssrSearch:e=""}={})=>l(i,()=>e),parser:t,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},E=r.createContext(v),b=()=>r.useContext(E),k={},C=r.createContext(k),g=e=>{const[t,r]=e.hook(e);return[m(e.base,t),n((t,n)=>r(((e,t)=>"~"===e[0]?e.slice(1):d(t)+e)(t,e.base),n))]},x=()=>g(b()),w=(e,t,r,n)=>{const{pattern:s,keys:o}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",n),a=s.exec(r)||[],[c,...l]=a;return void 0!==c?[!0,(()=>{const e=!1!==o?Object.fromEntries(o.map((e,t)=>[e,l[t]])):a.groups;let t={...l};return e&&Object.assign(t,e),t})(),...n?[c]:[]]:[!1,null]},S=({children:e,...t})=>{const n=b(),s=t.hook?v:n;let o=s;const[a,c]=t.ssrPath?.split("?")??[];c&&(t.ssrSearch=c,t.ssrPath=a),t.hrefs=t.hrefs??t.hook?.hrefs;let l=r.useRef({}),i=l.current,h=i;for(let r in s){const e="base"===r?s[r]+(t[r]||""):t[r]||s[r];i===h&&e!==h[r]&&(l.current=h={...h}),h[r]=e,e===s[r]&&e===o[r]||(o=h)}return r.createElement(E.Provider,{value:o,children:e})},j=({children:e,component:t},n)=>t?r.createElement(t,{params:n}):"function"==typeof e?e(n):e,P=({path:e,nest:t,match:n,...s})=>{const o=b(),[a]=g(o),[c,l,i]=n??w(o.parser,e,a,t),h=(e=>{let t=r.useRef(k);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([e,t])=>t!==n[e])?e:n})({...r.useContext(C),...l});if(!c)return null;const u=i?r.createElement(S,{base:i},j(s,h)):j(s,h);return r.createElement(C.Provider,{value:h,children:u})},O=r.forwardRef((e,t)=>{const s=b(),[o,a]=g(s),{to:c="",href:l=c,onClick:i,asChild:h,children:u,className:f,replace:p,state:d,...m}=e,y=n(t=>{t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||0!==t.button||(i?.(t),t.defaultPrevented||(t.preventDefault(),a(l,e)))}),v=s.hrefs("~"===l[0]?l.slice(1):s.base+l,s);return h&&r.isValidElement(u)?r.cloneElement(u,{onClick:y,href:v}):r.createElement("a",{...m,onClick:y,href:v,className:f?.call?f(o===l):f,children:u,ref:t})}),R=e=>Array.isArray(e)?e.flatMap(e=>R(e&&e.type===r.Fragment?e.props.children:e)):[e],L=({children:e,location:t})=>{const n=b(),[s]=g(n);for(const o of R(e)){let e=0;if(r.isValidElement(o)&&(e=w(n.parser,o.props.path,t||s,o.props.nest))[0])return r.cloneElement(o,{match:e})}return null};export{O as L,P as R,L as S,x as u};
//# sourceMappingURL=router-DWdTB6w7.js.map
