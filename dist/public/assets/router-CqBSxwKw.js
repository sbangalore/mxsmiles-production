import{E as e,Q as t}from"./vendor-CMZbyQBR.js";import{r,u as s}from"./react-core-EZAkOSE_.js";const n="pushState",o="replaceState",a=["popstate",n,o,"hashchange"],c=e=>{for(const t of a)addEventListener(t,e);return()=>{for(const t of a)removeEventListener(t,e)}},l=(t,r)=>e.useSyncExternalStore(c,t,r),i=()=>location.search,h=()=>location.pathname,u=({ssrPath:e}={})=>l(h,e?()=>e:h),f=(e,{replace:t=!1,state:r=null}={})=>history[t?o:n](r,"",e),p=Symbol.for("wouter_v3");if("undefined"!=typeof history&&void 0===window[p]){for(const e of[n,o]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,p,{value:!0})}const d=(e="")=>"/"===e?"":e,m=(e="",t)=>((e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/")(y(d(e)),y(t)),y=e=>{try{return decodeURI(e)}catch(t){return e}},v={hook:(e={})=>[u(e),f],searchHook:({ssrSearch:e=""}={})=>l(i,()=>e),parser:t,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},E=r.createContext(v),b=()=>r.useContext(E),k={},C=r.createContext(k),x=e=>{const[t,r]=e.hook(e);return[m(e.base,t),s((t,s)=>r(((e,t)=>"~"===e[0]?e.slice(1):d(t)+e)(t,e.base),s))]},g=()=>x(b()),w=(e,t,r,s)=>{const{pattern:n,keys:o}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),a=n.exec(r)||[],[c,...l]=a;return void 0!==c?[!0,(()=>{const e=!1!==o?Object.fromEntries(o.map((e,t)=>[e,l[t]])):a.groups;let t={...l};return e&&Object.assign(t,e),t})(),...s?[c]:[]]:[!1,null]},S=e=>w(b().parser,e,g()[0]),j=({children:e,...t})=>{const s=b(),n=t.hook?v:s;let o=n;const[a,c]=t.ssrPath?.split("?")??[];c&&(t.ssrSearch=c,t.ssrPath=a),t.hrefs=t.hrefs??t.hook?.hrefs;let l=r.useRef({}),i=l.current,h=i;for(let r in n){const e="base"===r?n[r]+(t[r]||""):t[r]||n[r];i===h&&e!==h[r]&&(l.current=h={...h}),h[r]=e,e===n[r]&&e===o[r]||(o=h)}return r.createElement(E.Provider,{value:o,children:e})},P=({children:e,component:t},s)=>t?r.createElement(t,{params:s}):"function"==typeof e?e(s):e,O=({path:e,nest:t,match:s,...n})=>{const o=b(),[a]=x(o),[c,l,i]=s??w(o.parser,e,a,t),h=(e=>{let t=r.useRef(k);const s=t.current;return t.current=Object.keys(e).length!==Object.keys(s).length||Object.entries(e).some(([e,t])=>t!==s[e])?e:s})({...r.useContext(C),...l});if(!c)return null;const u=i?r.createElement(j,{base:i},P(n,h)):P(n,h);return r.createElement(C.Provider,{value:h,children:u})},R=r.forwardRef((e,t)=>{const n=b(),[o,a]=x(n),{to:c="",href:l=c,onClick:i,asChild:h,children:u,className:f,replace:p,state:d,...m}=e,y=s(t=>{t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||0!==t.button||(i?.(t),t.defaultPrevented||(t.preventDefault(),a(l,e)))}),v=n.hrefs("~"===l[0]?l.slice(1):n.base+l,n);return h&&r.isValidElement(u)?r.cloneElement(u,{onClick:y,href:v}):r.createElement("a",{...m,onClick:y,href:v,className:f?.call?f(o===l):f,children:u,ref:t})}),L=e=>Array.isArray(e)?e.flatMap(e=>L(e&&e.type===r.Fragment?e.props.children:e)):[e],K=({children:e,location:t})=>{const s=b(),[n]=x(s);for(const o of L(e)){let e=0;if(r.isValidElement(o)&&(e=w(s.parser,o.props.path,t||n,o.props.nest))[0])return r.cloneElement(o,{match:e})}return null};export{R as L,O as R,K as S,S as a,g as u};
//# sourceMappingURL=router-CqBSxwKw.js.map
